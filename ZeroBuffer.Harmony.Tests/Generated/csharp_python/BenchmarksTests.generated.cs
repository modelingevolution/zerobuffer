// <auto-generated />
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;
using Xunit;
using Xunit.Abstractions;
using ModelingEvolution.Harmony.Core;
using ModelingEvolution.Harmony.Execution;
using ModelingEvolution.Harmony.ProcessManagement;
using Microsoft.Extensions.Logging.Abstractions;
using ZeroBuffer.Harmony.Tests;

namespace ZeroBuffer.Harmony.Tests.Csharp_Python;

public class BenchmarksTests : HarmonyTestBase
{
    public BenchmarksTests(ITestOutputHelper output) : base(output) { }

    #region Static Test Data
    private static readonly string Test_14_1_Latency_Benchmark_reader_csharp_writer_python_Json = @"{""TestId"":""csharp-python-test-14-1---latency-benchmark"",""FeatureId"":14,""ScenarioName"":""Test 14.1 - Latency Benchmark"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""csharp"",""writer"":""python""},""Background"":[{""Type"":""Given"",""Text"":""benchmark environment is prepared"",""Process"":null,""ProcessedText"":""benchmark environment is prepared"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027bench-latency\u0027 with default config"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027bench-latency\u0027 with default config"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027bench-latency\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027bench-latency\u0027"",""Parameters"":{}},{""Type"":""Then"",""Text"":""measure latency for frame sizes:"",""Process"":""writer"",""ProcessedText"":""measure latency for frame sizes:"",""Parameters"":{}},{""Type"":""Then"",""Text"":""report Min, Max, Mean, P50, P90, P99, P99.9"",""Process"":""writer"",""ProcessedText"":""report Min, Max, Mean, P50, P90, P99, P99.9"",""Parameters"":{}}]}";
    private static readonly string Test_14_2_Throughput_Benchmark_reader_csharp_writer_python_Json = @"{""TestId"":""csharp-python-test-14-2---throughput-benchmark"",""FeatureId"":14,""ScenarioName"":""Test 14.2 - Throughput Benchmark"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""csharp"",""writer"":""python""},""Background"":[{""Type"":""Given"",""Text"":""benchmark environment is prepared"",""Process"":null,""ProcessedText"":""benchmark environment is prepared"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027bench-throughput\u0027 with large config"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027bench-throughput\u0027 with large config"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027bench-throughput\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027bench-throughput\u0027"",""Parameters"":{}},{""Type"":""Then"",""Text"":""measure throughput for \u002760\u0027 seconds with frame sizes:"",""Process"":""writer"",""ProcessedText"":""measure throughput for \u002760\u0027 seconds with frame sizes:"",""Parameters"":{}},{""Type"":""Then"",""Text"":""report CPU usage percentage"",""Process"":""writer"",""ProcessedText"":""report CPU usage percentage"",""Parameters"":{}},{""Type"":""Then"",""Text"":""expect to saturate memory bandwidth"",""Process"":""writer"",""ProcessedText"":""expect to saturate memory bandwidth"",""Parameters"":{}}]}";
    private static readonly string Test_14_6_Buffer_Utilization_Under_Load_reader_csharp_writer_python_Json = @"{""TestId"":""csharp-python-test-14-6---buffer-utilization-under-load"",""FeatureId"":14,""ScenarioName"":""Test 14.6 - Buffer Utilization Under Load"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""csharp"",""writer"":""python""},""Background"":[{""Type"":""Given"",""Text"":""benchmark environment is prepared"",""Process"":null,""ProcessedText"":""benchmark environment is prepared"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027bench-utilization\u0027 with default config"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027bench-utilization\u0027 with default config"",""Parameters"":{}},{""Type"":""Given"",""Text"":""the \u0027writer\u0027 process is configured to be faster than reader"",""Process"":""writer"",""ProcessedText"":""is configured to be faster than reader"",""Parameters"":{}},{""Type"":""When"",""Text"":""monitor buffer utilization over time"",""Process"":""writer"",""ProcessedText"":""monitor buffer utilization over time"",""Parameters"":{}},{""Type"":""Then"",""Text"":""verify degradation detection at \u002780%\u0027"",""Process"":""writer"",""ProcessedText"":""verify degradation detection at \u002780%\u0027"",""Parameters"":{}},{""Type"":""Then"",""Text"":""report time to degradation"",""Process"":""writer"",""ProcessedText"":""report time to degradation"",""Parameters"":{}},{""Type"":""Then"",""Text"":""report recovery time"",""Process"":""writer"",""ProcessedText"":""report recovery time"",""Parameters"":{}}]}";

    #endregion

    #region Scenarios Collection
    public static IEnumerable<ScenarioExecution> Scenarios => new[]
    {
        DeserializeScenarioStatic(Test_14_1_Latency_Benchmark_reader_csharp_writer_python_Json),
        DeserializeScenarioStatic(Test_14_2_Throughput_Benchmark_reader_csharp_writer_python_Json),
        DeserializeScenarioStatic(Test_14_6_Buffer_Utilization_Under_Load_reader_csharp_writer_python_Json)
    };
    #endregion

    #region Test Methods
    [Fact(DisplayName = "Test 14.1 - Latency Benchmark [reader=csharp, writer=python]")]
    [Trait("Scenario", "Test 14.1 - Latency Benchmark")]
    [Trait("Platform", "csharp/python")]
    [Trait("Uses", "csharp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "14-Benchmarks")]    public async Task Test_14_1_Latency_Benchmark_reader_csharp_writer_python()
    {
        var scenario = DeserializeScenario(Test_14_1_Latency_Benchmark_reader_csharp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 14.2 - Throughput Benchmark [reader=csharp, writer=python]")]
    [Trait("Scenario", "Test 14.2 - Throughput Benchmark")]
    [Trait("Platform", "csharp/python")]
    [Trait("Uses", "csharp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "14-Benchmarks")]    public async Task Test_14_2_Throughput_Benchmark_reader_csharp_writer_python()
    {
        var scenario = DeserializeScenario(Test_14_2_Throughput_Benchmark_reader_csharp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 14.6 - Buffer Utilization Under Load [reader=csharp, writer=python]")]
    [Trait("Scenario", "Test 14.6 - Buffer Utilization Under Load")]
    [Trait("Platform", "csharp/python")]
    [Trait("Uses", "csharp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "14-Benchmarks")]    public async Task Test_14_6_Buffer_Utilization_Under_Load_reader_csharp_writer_python()
    {
        var scenario = DeserializeScenario(Test_14_6_Buffer_Utilization_Under_Load_reader_csharp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }


    #endregion
}