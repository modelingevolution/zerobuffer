// <auto-generated />
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;
using Xunit;
using Xunit.Abstractions;
using ModelingEvolution.Harmony.Core;
using ModelingEvolution.Harmony.Execution;
using ModelingEvolution.Harmony.ProcessManagement;
using Microsoft.Extensions.Logging.Abstractions;
using ZeroBuffer.Harmony.Tests;

namespace ZeroBuffer.Harmony.Tests.Csharp_Python;

public class ErrorHandlingTests : HarmonyTestBase
{
    public ErrorHandlingTests(ITestOutputHelper output) : base(output) { }

    #region Static Test Data
    private static readonly string Test_3_1_Metadata_Write_Once_Enforcement_reader_csharp_writer_python_Json = @"{""TestId"":""csharp-python-test-3-1---metadata-write-once-enforcement"",""FeatureId"":3,""ScenarioName"":""Test 3.1 - Metadata Write-Once Enforcement"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""csharp"",""writer"":""python""},""Background"":[],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027test-metadata-once\u0027 with metadata size \u00271024\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027test-metadata-once\u0027 with metadata size \u00271024\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027test-metadata-once\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027test-metadata-once\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process writes metadata with size \u0027500\u0027"",""Process"":""writer"",""ProcessedText"":""writes metadata with size \u0027500\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process writes frame with data \u0027test\u0027"",""Process"":""writer"",""ProcessedText"":""writes frame with data \u0027test\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process attempts to write metadata again with size \u0027200\u0027"",""Process"":""writer"",""ProcessedText"":""attempts to write metadata again with size \u0027200\u0027"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the second metadata write should fail"",""Process"":null,""ProcessedText"":""the second metadata write should fail"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the original metadata should remain unchanged"",""Process"":""writer"",""ProcessedText"":""the original metadata should remain unchanged"",""Parameters"":{}}]}";
    private static readonly string Test_3_2_Metadata_Size_Overflow_reader_csharp_writer_python_Json = @"{""TestId"":""csharp-python-test-3-2---metadata-size-overflow"",""FeatureId"":3,""ScenarioName"":""Test 3.2 - Metadata Size Overflow"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""csharp"",""writer"":""python""},""Background"":[],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027test-metadata-overflow\u0027 with metadata size \u00271024\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027test-metadata-overflow\u0027 with metadata size \u00271024\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027test-metadata-overflow\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027test-metadata-overflow\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process attempts to write metadata with size \u00272048\u0027"",""Process"":""writer"",""ProcessedText"":""attempts to write metadata with size \u00272048\u0027"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the metadata write should fail with size error"",""Process"":null,""ProcessedText"":""the metadata write should fail with size error"",""Parameters"":{}}]}";
    private static readonly string Test_3_3_Zero_Metadata_Configuration_reader_csharp_writer_python_Json = @"{""TestId"":""csharp-python-test-3-3---zero-metadata-configuration"",""FeatureId"":3,""ScenarioName"":""Test 3.3 - Zero Metadata Configuration"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""csharp"",""writer"":""python""},""Background"":[],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027test-no-metadata\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027test-no-metadata\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027test-no-metadata\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027test-no-metadata\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process writes frames without metadata"",""Process"":""writer"",""ProcessedText"":""writes frames without metadata"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the \u0027reader\u0027 process should read frames successfully"",""Process"":""reader"",""ProcessedText"":""should read frames successfully"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the system should work without metadata"",""Process"":""reader"",""ProcessedText"":""the system should work without metadata"",""Parameters"":{}}]}";

    #endregion

    #region Scenarios Collection
    public static IEnumerable<ScenarioExecution> Scenarios => new[]
    {
        DeserializeScenarioStatic(Test_3_1_Metadata_Write_Once_Enforcement_reader_csharp_writer_python_Json),
        DeserializeScenarioStatic(Test_3_2_Metadata_Size_Overflow_reader_csharp_writer_python_Json),
        DeserializeScenarioStatic(Test_3_3_Zero_Metadata_Configuration_reader_csharp_writer_python_Json)
    };
    #endregion

    #region Test Methods
    [Fact(DisplayName = "Test 3.1 - Metadata Write-Once Enforcement [reader=csharp, writer=python]")]
    [Trait("Scenario", "Test 3.1 - Metadata Write-Once Enforcement")]
    [Trait("Platform", "csharp/python")]
    [Trait("Uses", "csharp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "03-ErrorHandling")]    public async Task Test_3_1_Metadata_Write_Once_Enforcement_reader_csharp_writer_python()
    {
        var scenario = DeserializeScenario(Test_3_1_Metadata_Write_Once_Enforcement_reader_csharp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 3.2 - Metadata Size Overflow [reader=csharp, writer=python]")]
    [Trait("Scenario", "Test 3.2 - Metadata Size Overflow")]
    [Trait("Platform", "csharp/python")]
    [Trait("Uses", "csharp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "03-ErrorHandling")]    public async Task Test_3_2_Metadata_Size_Overflow_reader_csharp_writer_python()
    {
        var scenario = DeserializeScenario(Test_3_2_Metadata_Size_Overflow_reader_csharp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 3.3 - Zero Metadata Configuration [reader=csharp, writer=python]")]
    [Trait("Scenario", "Test 3.3 - Zero Metadata Configuration")]
    [Trait("Platform", "csharp/python")]
    [Trait("Uses", "csharp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "03-ErrorHandling")]    public async Task Test_3_3_Zero_Metadata_Configuration_reader_csharp_writer_python()
    {
        var scenario = DeserializeScenario(Test_3_3_Zero_Metadata_Configuration_reader_csharp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }


    #endregion
}