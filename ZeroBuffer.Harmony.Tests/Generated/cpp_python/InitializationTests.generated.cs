// <auto-generated />
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;
using Xunit;
using Xunit.Abstractions;
using ModelingEvolution.Harmony.Core;
using ModelingEvolution.Harmony.Execution;
using ModelingEvolution.Harmony.ProcessManagement;
using Microsoft.Extensions.Logging.Abstractions;
using ZeroBuffer.Harmony.Tests;

namespace ZeroBuffer.Harmony.Tests.Cpp_Python;

public class InitializationTests : HarmonyTestBase
{
    public InitializationTests(ITestOutputHelper output) : base(output) { }

    #region Static Test Data
    private static readonly string Test_4_3_Zero_Metadata_Configuration_reader_cpp_writer_python_Json = @"{""TestId"":""cpp-python-test-4-3---zero-metadata-configuration"",""FeatureId"":7,""ScenarioName"":""Test 4.3 - Zero Metadata Configuration"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""python""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027test-no-metadata\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027test-no-metadata\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027test-no-metadata\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027test-no-metadata\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process writes frames without metadata"",""Process"":""writer"",""ProcessedText"":""writes frames without metadata"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the \u0027reader\u0027 process should read frames successfully"",""Process"":""reader"",""ProcessedText"":""should read frames successfully"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the system should work without metadata"",""Process"":""reader"",""ProcessedText"":""the system should work without metadata"",""Parameters"":{}}]}";
    private static readonly string Test_10_5_Writer_Death_During_Read_reader_cpp_writer_python_Json = @"{""TestId"":""cpp-python-test-10-5---writer-death-during-read"",""FeatureId"":7,""ScenarioName"":""Test 10.5 - Writer Death During Read"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""python""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the \u0027reader\u0027 process creates buffer \u0027test-writer-death-read\u0027 with default config"",""Process"":""reader"",""ProcessedText"":""creates buffer \u0027test-writer-death-read\u0027 with default config"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process connects to buffer \u0027test-writer-death-read\u0027"",""Process"":""writer"",""ProcessedText"":""connects to buffer \u0027test-writer-death-read\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027reader\u0027 process waits on semaphore for data"",""Process"":""reader"",""ProcessedText"":""waits on semaphore for data"",""Parameters"":{}},{""Type"":""When"",""Text"":""the \u0027writer\u0027 process crashes while reader blocked"",""Process"":""writer"",""ProcessedText"":""crashes while reader blocked"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the \u0027reader\u0027 process should detect writer death after timeout \u00275\u0027 seconds"",""Process"":""reader"",""ProcessedText"":""should detect writer death after timeout \u00275\u0027 seconds"",""Parameters"":{}},{""Type"":""Then"",""Text"":""the \u0027reader\u0027 process should throw writer dead exception"",""Process"":""reader"",""ProcessedText"":""should throw writer dead exception"",""Parameters"":{}}]}";

    #endregion

    #region Scenarios Collection
    public static IEnumerable<ScenarioExecution> Scenarios => new[]
    {
        DeserializeScenarioStatic(Test_4_3_Zero_Metadata_Configuration_reader_cpp_writer_python_Json),
        DeserializeScenarioStatic(Test_10_5_Writer_Death_During_Read_reader_cpp_writer_python_Json)
    };
    #endregion

    #region Test Methods
    [Fact(DisplayName = "Test 4.3 - Zero Metadata Configuration [reader=cpp, writer=python]")]
    [Trait("Scenario", "Test 4.3 - Zero Metadata Configuration")]
    [Trait("Platform", "cpp/python")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "Initialization")]    public async Task Test_4_3_Zero_Metadata_Configuration_reader_cpp_writer_python()
    {
        var scenario = DeserializeScenario(Test_4_3_Zero_Metadata_Configuration_reader_cpp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 10.5 - Writer Death During Read [reader=cpp, writer=python]")]
    [Trait("Scenario", "Test 10.5 - Writer Death During Read")]
    [Trait("Platform", "cpp/python")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "python")]
    [Trait("Feature", "Initialization")]    public async Task Test_10_5_Writer_Death_During_Read_reader_cpp_writer_python()
    {
        var scenario = DeserializeScenario(Test_10_5_Writer_Death_During_Read_reader_cpp_writer_python_Json);
        await ExecuteScenarioAsync(scenario);
    }


    #endregion
}