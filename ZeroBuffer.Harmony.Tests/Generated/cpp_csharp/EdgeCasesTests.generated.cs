// <auto-generated />
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;
using Xunit;
using Xunit.Abstractions;
using ModelingEvolution.Harmony.Core;
using ModelingEvolution.Harmony.Execution;
using ModelingEvolution.Harmony.ProcessManagement;
using Microsoft.Extensions.Logging.Abstractions;
using ZeroBuffer.Harmony.Tests;

namespace ZeroBuffer.Harmony.Tests.Cpp_Csharp;

public class EdgeCasesTests : HarmonyTestBase
{
    public EdgeCasesTests(ITestOutputHelper output) : base(output) { }

    #region Static Test Data
    private static readonly string Test_11_3_Zero_Sized_Metadata_Block_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-11-3---zero-sized-metadata-block"",""FeatureId"":5,""ScenarioName"":""Test 11.3 - Zero-Sized Metadata Block"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-zero-metadata\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-zero-metadata\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-zero-metadata\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-zero-metadata\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""attempt to write metadata"",""Process"":""writer"",""ProcessedText"":""attempt to write metadata"",""Parameters"":{}},{""Type"":""Then"",""Text"":""metadata write should fail appropriately"",""Process"":null,""ProcessedText"":""metadata write should fail appropriately"",""Parameters"":{}},{""Type"":""When"",""Text"":""write frame without metadata"",""Process"":null,""ProcessedText"":""write frame without metadata"",""Parameters"":{}},{""Type"":""Then"",""Text"":""frame write should succeed"",""Process"":null,""ProcessedText"":""frame write should succeed"",""Parameters"":{}},{""Type"":""Then"",""Text"":""system should work correctly without metadata"",""Process"":""writer"",""ProcessedText"":""system should work correctly without metadata"",""Parameters"":{}}]}";
    private static readonly string Test_11_4_Minimum_Buffer_Sizes_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-11-4---minimum-buffer-sizes"",""FeatureId"":5,""ScenarioName"":""Test 11.4 - Minimum Buffer Sizes"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-minimum\u0027 with minimum viable size \u002717\u0027"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-minimum\u0027 with minimum viable size \u002717\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-minimum\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-minimum\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""write single byte frame"",""Process"":""writer"",""ProcessedText"":""write single byte frame"",""Parameters"":{}},{""Type"":""Then"",""Text"":""write should succeed"",""Process"":null,""ProcessedText"":""write should succeed"",""Parameters"":{}},{""Type"":""When"",""Text"":""attempt to write \u00272\u0027 byte frame"",""Process"":null,""ProcessedText"":""attempt to write \u00272\u0027 byte frame"",""Parameters"":{}},{""Type"":""Then"",""Text"":""writer should block waiting for space"",""Process"":null,""ProcessedText"":""writer should block waiting for space"",""Parameters"":{}}]}";
    private static readonly string Test_5_5_Wrap_Around_With_Wasted_Space_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-5-5---wrap-around-with-wasted-space"",""FeatureId"":5,""ScenarioName"":""Test 5.5 - Wrap-Around With Wasted Space"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-waste\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-waste\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-waste\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-waste\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""write frame that leaves \u0027100\u0027 bytes at end"",""Process"":""writer"",""ProcessedText"":""write frame that leaves \u0027100\u0027 bytes at end"",""Parameters"":{}},{""Type"":""When"",""Text"":""attempt to write \u0027200\u0027 byte frame"",""Process"":""writer"",""ProcessedText"":""attempt to write \u0027200\u0027 byte frame"",""Parameters"":{}},{""Type"":""Then"",""Text"":""writer should write wrap marker at current position"",""Process"":null,""ProcessedText"":""writer should write wrap marker at current position"",""Parameters"":{}},{""Type"":""Then"",""Text"":""payload_free_bytes should be reduced by wasted space"",""Process"":""writer"",""ProcessedText"":""payload_free_bytes should be reduced by wasted space"",""Parameters"":{}},{""Type"":""Then"",""Text"":""frame should be written at buffer start"",""Process"":""writer"",""ProcessedText"":""frame should be written at buffer start"",""Parameters"":{}},{""Type"":""When"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""read next frame"",""Process"":""reader"",""ProcessedText"":""read next frame"",""Parameters"":{}},{""Type"":""Then"",""Text"":""reader should detect wrap marker"",""Process"":null,""ProcessedText"":""reader should detect wrap marker"",""Parameters"":{}},{""Type"":""Then"",""Text"":""reader should jump to buffer start"",""Process"":""reader"",""ProcessedText"":""reader should jump to buffer start"",""Parameters"":{}},{""Type"":""Then"",""Text"":""read \u0027200\u0027 byte frame successfully"",""Process"":""reader"",""ProcessedText"":""read \u0027200\u0027 byte frame successfully"",""Parameters"":{}}]}";
    private static readonly string Test_5_7_Maximum_Frame_Size_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-5-7---maximum-frame-size"",""FeatureId"":5,""ScenarioName"":""Test 5.7 - Maximum Frame Size"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-max-frame\u0027 with metadata size \u00270\u0027 and payload size \u0027104857600\u0027"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-max-frame\u0027 with metadata size \u00270\u0027 and payload size \u0027104857600\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-max-frame\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-max-frame\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""write frame matching exactly payload size minus header"",""Process"":""writer"",""ProcessedText"":""write frame matching exactly payload size minus header"",""Parameters"":{}},{""Type"":""Then"",""Text"":""frame should be written successfully"",""Process"":null,""ProcessedText"":""frame should be written successfully"",""Parameters"":{}},{""Type"":""When"",""Text"":""attempt to write frame exceeding payload size"",""Process"":null,""ProcessedText"":""attempt to write frame exceeding payload size"",""Parameters"":{}},{""Type"":""Then"",""Text"":""write should be rejected with appropriate error"",""Process"":null,""ProcessedText"":""write should be rejected with appropriate error"",""Parameters"":{}}]}";
    private static readonly string Test_11_5_Reader_Slower_Than_Writer_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-11-5---reader-slower-than-writer"",""FeatureId"":5,""ScenarioName"":""Test 11.5 - Reader Slower Than Writer"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-reader-slower\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-reader-slower\u0027 with metadata size \u00270\u0027 and payload size \u002710240\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-reader-slower\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-reader-slower\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""write continuously at high speed"",""Process"":""writer"",""ProcessedText"":""write continuously at high speed"",""Parameters"":{}},{""Type"":""When"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""process with \u002710\u0027 ms delay per frame"",""Process"":""reader"",""ProcessedText"":""process with \u002710\u0027 ms delay per frame"",""Parameters"":{}},{""Type"":""When"",""Text"":""run for \u00271000\u0027 frames"",""Process"":""reader"",""ProcessedText"":""run for \u00271000\u0027 frames"",""Parameters"":{}},{""Type"":""Then"",""Text"":""no frames should be lost"",""Process"":null,""ProcessedText"":""no frames should be lost"",""Parameters"":{}},{""Type"":""Then"",""Text"":""writer should block appropriately"",""Process"":""reader"",""ProcessedText"":""writer should block appropriately"",""Parameters"":{}},{""Type"":""Then"",""Text"":""flow control should work correctly"",""Process"":""reader"",""ProcessedText"":""flow control should work correctly"",""Parameters"":{}}]}";
    private static readonly string Test_13_1_Protocol_Compliance_OIEB_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-13-1---protocol-compliance-oieb"",""FeatureId"":5,""ScenarioName"":""Test 13.1 - Protocol Compliance OIEB"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-oieb-compliance\u0027 with default config"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-oieb-compliance\u0027 with default config"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-oieb-compliance\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-oieb-compliance\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""perform multiple write operations"",""Process"":""writer"",""ProcessedText"":""perform multiple write operations"",""Parameters"":{}},{""Type"":""Then"",""Text"":""after each write verify:"",""Process"":null,""ProcessedText"":""after each write verify:"",""Parameters"":{}},{""Type"":""When"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""perform multiple read operations"",""Process"":""reader"",""ProcessedText"":""perform multiple read operations"",""Parameters"":{}},{""Type"":""Then"",""Text"":""after each read verify:"",""Process"":null,""ProcessedText"":""after each read verify:"",""Parameters"":{}}]}";
    private static readonly string Test_13_2_Memory_Alignment_Verification_reader_cpp_writer_csharp_Json = @"{""TestId"":""cpp-csharp-test-13-2---memory-alignment-verification"",""FeatureId"":5,""ScenarioName"":""Test 13.2 - Memory Alignment Verification"",""ScenarioDescription"":null,""Tags"":[],""Platforms"":{""reader"":""cpp"",""writer"":""csharp""},""Background"":[{""Type"":""Given"",""Text"":""the test mode is configured"",""Process"":null,""ProcessedText"":""the test mode is configured"",""Parameters"":{}}],""Steps"":[{""Type"":""Given"",""Text"":""the reader is \u0027csharp\u0027"",""Process"":""reader"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""Given"",""Text"":""create buffer \u0027test-alignment\u0027 with default config"",""Process"":""reader"",""ProcessedText"":""create buffer \u0027test-alignment\u0027 with default config"",""Parameters"":{}},{""Type"":""Then"",""Text"":""verify OIEB starts at 64-byte aligned address"",""Process"":null,""ProcessedText"":""verify OIEB starts at 64-byte aligned address"",""Parameters"":{}},{""Type"":""Then"",""Text"":""verify metadata block starts at 64-byte aligned offset"",""Process"":""reader"",""ProcessedText"":""verify metadata block starts at 64-byte aligned offset"",""Parameters"":{}},{""Type"":""Then"",""Text"":""verify payload block starts at 64-byte aligned offset"",""Process"":""reader"",""ProcessedText"":""verify payload block starts at 64-byte aligned offset"",""Parameters"":{}},{""Type"":""When"",""Text"":""the writer is \u0027python\u0027"",""Process"":""writer"",""ProcessedText"":"""",""Parameters"":{}},{""Type"":""When"",""Text"":""connect to buffer \u0027test-alignment\u0027"",""Process"":""writer"",""ProcessedText"":""connect to buffer \u0027test-alignment\u0027"",""Parameters"":{}},{""Type"":""When"",""Text"":""write various sized frames"",""Process"":""writer"",""ProcessedText"":""write various sized frames"",""Parameters"":{}},{""Type"":""Then"",""Text"":""verify all data access respects alignment"",""Process"":null,""ProcessedText"":""verify all data access respects alignment"",""Parameters"":{}}]}";

    #endregion

    #region Scenarios Collection
    public static IEnumerable<ScenarioExecution> Scenarios => new[]
    {
        DeserializeScenarioStatic(Test_11_3_Zero_Sized_Metadata_Block_reader_cpp_writer_csharp_Json),
        DeserializeScenarioStatic(Test_11_4_Minimum_Buffer_Sizes_reader_cpp_writer_csharp_Json),
        DeserializeScenarioStatic(Test_5_5_Wrap_Around_With_Wasted_Space_reader_cpp_writer_csharp_Json),
        DeserializeScenarioStatic(Test_5_7_Maximum_Frame_Size_reader_cpp_writer_csharp_Json),
        DeserializeScenarioStatic(Test_11_5_Reader_Slower_Than_Writer_reader_cpp_writer_csharp_Json),
        DeserializeScenarioStatic(Test_13_1_Protocol_Compliance_OIEB_reader_cpp_writer_csharp_Json),
        DeserializeScenarioStatic(Test_13_2_Memory_Alignment_Verification_reader_cpp_writer_csharp_Json)
    };
    #endregion

    #region Test Methods
    [Fact(DisplayName = "Test 11.3 - Zero-Sized Metadata Block [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 11.3 - Zero-Sized Metadata Block")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_11_3_Zero_Sized_Metadata_Block_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_11_3_Zero_Sized_Metadata_Block_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 11.4 - Minimum Buffer Sizes [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 11.4 - Minimum Buffer Sizes")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_11_4_Minimum_Buffer_Sizes_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_11_4_Minimum_Buffer_Sizes_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 5.5 - Wrap-Around With Wasted Space [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 5.5 - Wrap-Around With Wasted Space")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_5_5_Wrap_Around_With_Wasted_Space_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_5_5_Wrap_Around_With_Wasted_Space_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 5.7 - Maximum Frame Size [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 5.7 - Maximum Frame Size")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_5_7_Maximum_Frame_Size_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_5_7_Maximum_Frame_Size_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 11.5 - Reader Slower Than Writer [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 11.5 - Reader Slower Than Writer")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_11_5_Reader_Slower_Than_Writer_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_11_5_Reader_Slower_Than_Writer_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 13.1 - Protocol Compliance OIEB [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 13.1 - Protocol Compliance OIEB")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_13_1_Protocol_Compliance_OIEB_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_13_1_Protocol_Compliance_OIEB_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }

    [Fact(DisplayName = "Test 13.2 - Memory Alignment Verification [reader=cpp, writer=csharp]")]
    [Trait("Scenario", "Test 13.2 - Memory Alignment Verification")]
    [Trait("Platform", "cpp/csharp")]
    [Trait("Uses", "cpp")]
    [Trait("Uses", "csharp")]
    [Trait("Feature", "EdgeCases")]    public async Task Test_13_2_Memory_Alignment_Verification_reader_cpp_writer_csharp()
    {
        var scenario = DeserializeScenario(Test_13_2_Memory_Alignment_Verification_reader_cpp_writer_csharp_Json);
        await ExecuteScenarioAsync(scenario);
    }


    #endregion
}